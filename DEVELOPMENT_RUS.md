# План разработки

## На что ориентироваться

Изначально был реализован Телеграм-бот на базе Google Apps с внесением данных в Google-таблицы.
Рабочий вариант тестового бота - [@DevWakeBot](https://t.me/DevWakeBot).


Соответственно в первую очередь необходимо реализовать существующий функционал на платформе Python3 + Flask.

## Принцип архитектуры

На веб-сервере создается объект обрабатываю поступающие запросы (Основной процессор бот), который на основании полученного запроса определяет текущее состояние чата.
Состояния могут быть: Начало общение с пользователем, Этап резервирования, Получение дополнительной информации и т.п.
На основании текущего состояния, Основной процессор создает соответствующий объект обработки сообщений, сообщает ему текущее состояние. Вызывает соответствующие поступившему запросу методы Обработчика сообщений. После этого получает измененный объект состояния и сохраняет/удаляет его.
Объект обработки сообщений на основании полученного состояния, при необходимости, создает объект резервирования и передает его объекту состояния чата. Обрабатывает состояние в соответствии с поступающими от Основного процессора вызовами. Он же загружает и сохраняет данные резервирования (если это обработчик резервирований).
При изменении Объекта состояния он вносит соответствующие изменения в резервирование.

P.S. Немного сумбурно, но планирую довести текст до ума)

## План работ

Естественно план является предварительным и будет корректироваться по мере продвижения работ.


Порядок пунктов плана не является порядком выполнения работ, пункты выполняются по мере необходимости. 

Естественно, работы зависящие друг от друга выполняются в соответствующем порядке, либо одновременно.


**ВАЖНО** - Тесты пишутся всегда до реализации кода.

- [ ] Модели базовых сущностей
  - [x] Создать класс пользователя
    - [x] Создать модель класса;
    - [x] Создать модульные тесты;
    - [x] Реализовать класс;
  - [x] Создать класс произвольного резервирования
    - [x] Создать модель класса;
    - [x] Создать модульные тесты;
    - [x] Реализовать класс;
  - [ ] Создать класс резервирования лебедки вейкборда
    - [ ] Создать модель класса;
    - [ ] Создать модульные тесты;
    - [ ] Реализовать класс;
- [ ] Разработка базы данных.
    - [ ] Таблицы сущностей.
      - [ ] Таблица резервирований вейкборда
    - [ ] Таблицы данных о пользователях.
      - [ ] Основная таблица данных пользователей.
    - [ ] Таблица хранения состояний бота.
    - [ ] Таблицы хранения настроек бота.
    - [ ] Сохраненные процедуры
      - [ ] Процедуры манипуляций сущностями.
      - [ ] Процедуры управления состояния бота.
      - [ ] Процедуры управления пользователями.
      - [ ] Процедуры изменения настроек бота.
    - [ ] Представления.
      - [ ] Представления сущностей.
      - [ ] Прочие представления по мере необходимости.
- [ ] Слой доступа к базе данных
    - [ ] Создание BDD-тестов слоя доступа к базе данных.
    - [ ] Реализация слоя доступа к базе данных.
- [ ] Отслеживание состояния процесса резервирования;
  - [ ] Создать класс отслеживания состояния произвольного резервирования;
    - [ ] Создать модель класса;
    - [ ] Создать BDD тесты;
    - [ ] Создать модульные тесты;
    - [ ] Реализовать класс;
  - [ ] Создать класс отслеживания состояния резервирования вейкборда;
    - [ ] Создать модель класса;
    - [ ] Создать BDD тесты;
    - [ ] Создать модульные тесты;
    - [ ] Реализовать класс;
- [ ] Процессоры обработки сообщений бота
  - [ ] Создать класс обработки сообщений произвольного резервирования;
    - [ ] Создать BDD тесты.
    - [ ] Создать модульные тесты;
    - [ ] Реализовать класс;
  - [ ] Создать класс обработки сообщений резервирования вейкборда;
    - [ ] Создать BDD тесты.
    - [ ] Создать модульные тесты;
    - [ ] Реализовать класс;
- [ ] Основной процессор бота - фактически планируется создать фабрику классов для различных мастеров (wizard) в боте.
    - [ ] Создать класс процессора бота;
      - [ ] Создать BDD тесты.
      - [ ] Создать модульные тесты.
      - [ ] Реализовать класс.
- [ ] Регистрация бота
- [ ] Первоначальная ручная заливка

